<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- sale order view for wallbox users and condo owners -->
    <record id="wallbox_sale_order_view_list_custom" model="ir.ui.view">
        <field name="name">sale.order.view.list.wallbox.custom</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_tree"/>
        <field name="mode">primary</field>
        <field name="arch" type="xml">
            <xpath expr="//list" position="attributes">
                <attribute name="edit">0</attribute>
                <attribute name="create">0</attribute>
                <attribute name="delete">0</attribute>
                <attribute name="expand">1</attribute>
            </xpath>
            <field name="activity_ids" position="replace"/>
            <field name="state" position="before">
                <field name="amount_paid" string="Amount Paid"/>
            </field>
            <field name="state" position="attributes">
                <attribute name="optional">show</attribute>
            </field>
        </field>
    </record>

    <record id="view_sale_order_form_inherit_wallbox" model="ir.ui.view">
        <field name="name">sale.order.form.inherit.wallbox</field>
        <field name="model">sale.order</field>
        <field name="mode">primary</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form" position="attributes">
                <attribute name="readonly">1</attribute>
                <attribute name="edit">0</attribute>
                <attribute name="create">0</attribute>
                <attribute name="delete">0</attribute>
            </xpath>
            <xpath expr="//field[@name='order_line']/list/field[@name='product_template_id']" position="attributes">
                <attribute name="invisible">1</attribute>
                <!-- <attribute name="options">{'no_create_edit': True, 'no_open': True}</attribute> -->
            </xpath>
            <xpath expr="//field[@name='order_line']/list/field[@name='product_id']" position="attributes">
                <attribute name="invisible">1</attribute>
                <!-- <attribute name="options">{'no_create_edit': True, 'no_open': True}</attribute> -->
            </xpath>
       </field>
    </record>

    <record id="action_wallbox_sale_order" model="ir.actions.act_window">
        <field name="name">Wallbox Sale Orders</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('request_charging_id', '!=', False)]</field>
        <field name="context">{
            'list_view_ref': 'wallbox_ecommerce_extended.wallbox_sale_order_view_list_custom',
            'form_view_ref': 'wallbox_ecommerce_extended.view_sale_order_form_inherit_wallbox',
            'search_default_customer': 1,
            'search_default_order_month': 1,
        }</field>
    </record>

    <!-- now this menu is not visible to sales persons -->
    <record id="sale.sale_menu_root" model="ir.ui.menu">
        <field name="groups_id" eval="[(4, ref('sales_team.group_sale_salesman_all_leads'))]"/>
    </record>

    <!-- hide all the website menu for the sales person - own documents -->
    <!-- Ecommerce menu -->
    <record id="website_sale.menu_ecommerce" model="ir.ui.menu">
        <field name="groups_id" eval="[(4, ref('sales_team.group_sale_salesman_all_leads')), (3, ref('sales_team.group_sale_salesman'))]"/>
    </record>

    <!-- Reporting menu -->
    <record id="website.menu_reporting" model="ir.ui.menu">
        <field name="groups_id" eval="[(4, ref('sales_team.group_sale_salesman_all_leads'))]"/>
    </record>

    <!-- Content Menu -->
    <record id="website.menu_content" model="ir.ui.menu">
        <field name="groups_id" eval="[(4, ref('sales_team.group_sale_salesman_all_leads'))]"/>
    </record>

    <menuitem id="wallbox_sale_order_menu" name="Wallbox Sale Orders" parent="wallbox_integration.menu_wallbox_main" action="action_wallbox_sale_order" sequence="99"/>

    <record id="sale_order_view_form_wallbox" model="ir.ui.view">
        <field name="name">sale.order.view.form.inherit.wallbox</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <field name="payment_term_id" position="after">
                <field name="wallbox_order_id" readonly="0"/>
                <field name="request_charging_id" readonly="1"/>
                <field name="has_wallbox_device" readonly="1" invisible="1"/>
                <field name="has_subscription" readonly="1" invisible="1"/>
                <field name="is_first_purchase" readonly="1" invisible="1"/>
            </field>
        </field>
    </record>

</odoo>
